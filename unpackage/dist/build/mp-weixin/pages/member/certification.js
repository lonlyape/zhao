(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/member/certification"],{"0e15":function(e,t,n){"use strict";var i=n("8e3d"),a=n.n(i);a.a},"3d0b":function(e,t,n){"use strict";n.r(t);var i=n("7cab"),a=n("d0c1");for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("0e15");var r,c=n("f0c5"),d=Object(c["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);t["default"]=d.exports},"5d26":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("4795")),a=n("2f62"),o=n("5e56");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,i,a,o,r){try{var c=e[o](r),d=c.value}catch(u){return void n(u)}c.done?t(d):Promise.resolve(d).then(i,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function r(e){c(o,i,a,r,d,"next",e)}function d(e){c(o,i,a,r,d,"throw",e)}r(void 0)}))}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return"".concat(t,"-").concat(n,"-").concat(i)}var f=function(){n.e("components/member/choose-region").then(function(){return resolve(n("3605"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("48c4"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/member/popup-cate").then(function(){return resolve(n("71b9"))}.bind(null,n)).catch(n.oe)},_=n("553c"),p={data:function(){return{isShow:!1,data:[],birthdate:"",endDate:h(),nationalityIndex:null,nationalityArray:[],regionId:"",regionName:"",regionObject:{province_id:"",city_id:""},cateId:"",cateName:"",id_card_img:"",hand_id_card_img:"",o_id_card_img:"",o_hand_id_card_img:""}},computed:s({},(0,a.mapState)(["hasLogin","userInfo"])),components:{chooseRegion:f,uniPopup:g,popupCate:m},onLoad:function(){this.loadData()},methods:{loadData:function(){var t=this;return d(i.default.mark((function n(){var a,o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a="nationalityData",o=t,e.showLoading({title:"数据加载中"}),n.next=5,e.getStorage({key:a,success:function(e){t.nationalityArray=e.data},fail:function(n){t.request.get(t.api.getNationalityData,{data:{}}).then((function(n){t.nationalityArray=n.data,e.setStorage({key:a,data:n.data})}))}});case 5:return n.next=7,t.request.post(t.api.getCertification,{data:{user_id:o.userInfo.uid}}).then((function(e){if(e.code){var n=function(e){o.birthdate=e.birthdate,o.regionId=e.more.region_id,o.regionName=e.more.region_name,o.cateId=e.more.cate_id,o.cateName=e.more.cate_name,o.id_card_img=e.id_card_img,o.o_id_card_img=e.id_card_img,o.hand_id_card_img=e.hand_id_card_img,o.o_hand_id_card_img=e.hand_id_card_img;var t=e.more.region_id.split(",");o.regionObject.province_id=t[0],t.length>1&&(o.regionObject.city_id=t[1]);for(var n=0;n<o.nationalityArray.length;n++)if(o.nationalityArray[n]===e.nationality){o.nationalityIndex=n;break}};t.data=e.data,n(e.data)}}));case 7:e.hideLoading();case 8:case"end":return n.stop()}}),n)})))()},bindDateChange:function(e){this.birthdate=e.detail.value},bindNationalityChange:function(e){this.nationalityIndex=e.detail.value},getChooseRegionVal:function(e){this.regionId=e.region_id,this.regionName=e.region_name},confirmCateChoose:function(e){this.cateId=e.cateId,this.cateName=e.cateName},togglePopup:function(e,t){"object"==typeof e?(this.isTextAreaShow=!0,this.$refs[e.ref].close()):(this.isTextAreaShow=!1,this.$refs[t].open())},chooseImage:function(t){var n=this,i="";"id_card_img"===t?i=this.id_card_img:"hand_id_card_img"===t&&(i=this.hand_id_card_img),e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(a){e.showLoading({title:"上传中",mask:!0}),(0,o.pathToBase64)(a.tempFilePaths[0]).then((function(o){n.request.post(n.api.base64ToImg,{data:{base64ImgStr:o,oldFile:i}}).then((function(i){e.hideLoading(),i.code?("id_card_img"===t?(n.id_card_img=i.data,n.o_id_card_img=a.tempFilePaths[0]):"hand_id_card_img"===t&&(n.hand_id_card_img=i.data,n.o_hand_id_card_img=a.tempFilePaths[0]),e.showToast({title:i.msg})):e.showModal({title:"提示",content:i.msg,showCancel:!1})})).catch((function(t){console.log(t),e.hideLoading(),e.showModal({title:"提示",content:"网络错误",showCancel:!1})}))})).catch((function(t){console.log(t),e.showModal({title:"提示",content:t,showCancel:!1})}))}})},recertification:function(){this.isShow=!0},submit:function(t){var n=this,i=t.detail.value,a=[{name:"name",checkType:"notnull",checkRule:"",errorMsg:"请输入姓名"},{name:"birthdate",checkType:"notnull",checkRule:"",errorMsg:"请选择出生日期"},{name:"nationality",checkType:"notnull",checkRule:"",errorMsg:"请选择民族"},{name:"id_card",checkType:"notnull",checkRule:"",errorMsg:"请输入身份证号码"},{name:"region",checkType:"notnull",checkRule:"",errorMsg:"请选择地区"},{name:"details_address",checkType:"notnull",checkRule:"",errorMsg:"请输入详细地址"},{name:"company_name",checkType:"notnull",checkRule:"",errorMsg:"请输入单位名称"},{name:"work",checkType:"notnull",checkRule:"",errorMsg:"请选择专业工种"},{name:"id_card_img",checkType:"notnull",checkRule:"",errorMsg:"请上传身份证正面"},{name:"hand_id_card_img",checkType:"notnull",checkRule:"",errorMsg:"请上传身份证手持图"}],o=_.check(i,a);o?(i.more={cate_id:i.cate_id,cate_name:i.cate_name,region_id:i.region_id,region_name:i.region_name,details_address:i.details_address},e.showLoading({title:"提交中",mask:!0}),this.request.post(this.api.certification,{data:i}).then((function(t){e.hideLoading(),t.code?(n.data.id?e.showToast({title:"重新提交成功"}):e.showToast({title:"提交成功"}),setTimeout((function(){e.redirectTo({url:"certification"})}),1e3)):e.showModal({title:"提示",content:t.msg,showCancel:!1})})).catch((function(t){console.log(t),e.hideLoading(),e.showModal({title:"提示",content:"网络错误",showCancel:!1})}))):this.func.msg(_.error)}}};t.default=p}).call(this,n("543d")["default"])},"7cab":function(e,t,n){"use strict";var i={uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"48c4"))}},a=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}))},"8e3d":function(e,t,n){},b3df:function(e,t,n){"use strict";(function(e){n("cc73");i(n("66fd"));var t=i(n("3d0b"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},d0c1:function(e,t,n){"use strict";n.r(t);var i=n("5d26"),a=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=a.a}},[["b3df","common/runtime","common/vendor"]]]);